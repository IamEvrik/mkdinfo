VERSION 5.00
Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} AdmServiceForm 
   Caption         =   "Сервис"
   ClientHeight    =   6510
   ClientLeft      =   45
   ClientTop       =   375
   ClientWidth     =   11310
   OleObjectBlob   =   "AdmServiceForm.frx":0000
   StartUpPosition =   1  'CenterOwner
End
Attribute VB_Name = "AdmServiceForm"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub UserForm_Activate()
' ----------------------------------------------------------------------------
' Активация формы
' ----------------------------------------------------------------------------
    Me.LabelServer.Caption = "Сервер - " & AppConfig.DBServer
End Sub


Private Sub BtnAddBldn_Click()
' ----------------------------------------------------------------------------
' Добавление дома
' ----------------------------------------------------------------------------
    Unload Me
    Call RunAddBldnForm
End Sub


Private Sub BtnLoadAVR_Click()
' ----------------------------------------------------------------------------
' Загрузка АВР
' ----------------------------------------------------------------------------
    Call loadAVR
    MsgBox "Завершено"
End Sub


Private Sub BtnLoadExpenses_Click()
' ----------------------------------------------------------------------------
' Загрузка расходов
' ----------------------------------------------------------------------------
    Call loadExpenses
    MsgBox "Завершено"
End Sub


Private Sub BtnOpenTerm_Click()
' ----------------------------------------------------------------------------
' Открытие месяца
' Last update: 17.09.2018
' ----------------------------------------------------------------------------
    Dim ans As Integer
    
    ans = MsgBox("Сейчас будет открыт месяц " & _
                (MonthName(Month(Terms.LastTerm.EndDate + 1))) & " " & _
                Year(Terms.LastTerm.EndDate + 1) & vbCrLf & "Продолжить?", _
                vbYesNo + vbQuestion, "Подтвердите открытие месяца")
    On Error Resume Next
    If ans = vbYes Then Terms.openTerm
    If Err.Number <> 0 Then
        MsgBox "Ошибка открытия периода", vbExclamation, "Ошибка"
        Err.Clear
    End If
End Sub


Private Sub BtnRepaintSheet_Click()
' ----------------------------------------------------------------------------
' Пересоздание листа с домами
' ----------------------------------------------------------------------------
    Call createWorksheet
    Unload Me
End Sub


Private Sub BtnToSite_Click()
' ----------------------------------------------------------------------------
' Создание отчётов для сайта
' ----------------------------------------------------------------------------
    Unload Me
    Call RunReport1Form("tosite")
End Sub


Private Sub BtnPassportToSite_Click()
' ----------------------------------------------------------------------------
' Создание паспортов для сайта
' ----------------------------------------------------------------------------
    Call PassportsToSite
End Sub


Private Sub BtnLoadSubaccounts_Click()
' ----------------------------------------------------------------------------
' Загрузка остатков на субсчетах
' ----------------------------------------------------------------------------
    Call loadSubAccounts
End Sub


Private Sub BtnUpdateExpenseFact_Click()
' ----------------------------------------------------------------------------
' Загрузка фактических расходов
' ----------------------------------------------------------------------------
    Call updateFactExpenses
    MsgBox "Готово"
End Sub


Private Sub BtnLoadSubaccount_Click()
' ----------------------------------------------------------------------------
' Загрузка плановых поступлений на субсчета
' ----------------------------------------------------------------------------
    Call loadPlanSubAccounts
End Sub


Private Sub BtnLoadMonthSubaccount_Click()
' ----------------------------------------------------------------------------
' Загрузка месячной информации по субсчетам
' ----------------------------------------------------------------------------
    Call loadSubAccountMonthData
End Sub


Private Sub BtnLoadRkcAccrued_Click()
' ----------------------------------------------------------------------------
' Загрузка информации о начислениях из РКЦ
' ----------------------------------------------------------------------------
    Call loadAccruedToBase(acRKC)
End Sub

Private Sub CommandButton1_Click()
' ----------------------------------------------------------------------------
' Загрузка информации о разовых начислениях из РКЦ
' ----------------------------------------------------------------------------
    Call loadRkcAddeds
End Sub


Private Sub BtnLoadOffceAccrued_Click()
' ----------------------------------------------------------------------------
' Загрузка информации о начислениях по офисам
' ----------------------------------------------------------------------------
    Call loadAccruedToBase(acBuh)
End Sub


Private Sub BtnLoadMoKapRemont_Click()
' ----------------------------------------------------------------------------
' Загрузка информации о начислениях взноса на КР по МО
' ----------------------------------------------------------------------------
    Call loadAccruedToBase(acMOKR)
End Sub


Private Sub BtnLoadMoUpper_Click()
' ----------------------------------------------------------------------------
' Загрузка информации о начислениях превышения по МО
' ----------------------------------------------------------------------------
    Call loadAccruedToBase(acMOUpper)
End Sub


Private Sub BtnLoadElectro_Click()
' ----------------------------------------------------------------------------
' Загрузка показаний электрических счетчиков
' ----------------------------------------------------------------------------
    Call loadMeterReadings
End Sub


Private Sub BtnOffersWorks_Click()
' ----------------------------------------------------------------------------
' Загрузка предложений по работам
' ----------------------------------------------------------------------------
    Call loadOffersWorks
End Sub

